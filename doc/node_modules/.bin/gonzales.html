<!DOCTYPE html>
<html>
<head>
  <title>gonzales</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/.bin/gonzales";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>gonzales</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">#!/usr/bin/env node</span>

<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> parseArgs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'minimist'</span>);
<span class="hljs-keyword">var</span> gonzales = <span class="hljs-built_in">require</span>(<span class="hljs-string">'..'</span>);
<span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">var</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-keyword">var</span> options = getOptions();

<span class="hljs-keyword">if</span> (options.help) {
  displayHelp();
  process.exit(<span class="hljs-number">0</span>);
}

<span class="hljs-keyword">if</span> (isSTDIN()) {
  processSTDIN();
} <span class="hljs-keyword">else</span> {
  processFile(options._[<span class="hljs-number">0</span>]);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getOptions</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> parserOptions = {
    <span class="hljs-attr">boolean</span>: [<span class="hljs-string">'silent'</span>, <span class="hljs-string">'simple'</span>],
    <span class="hljs-attr">alias</span>: {
      <span class="hljs-attr">help</span>: <span class="hljs-string">'h'</span>,
      <span class="hljs-attr">syntax</span>: <span class="hljs-string">'s'</span>,
      <span class="hljs-attr">context</span>: <span class="hljs-string">'c'</span>
    }
  };
  <span class="hljs-keyword">return</span> parseArgs(process.argv.slice(<span class="hljs-number">2</span>), parserOptions);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isSTDIN</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> options._.indexOf(<span class="hljs-string">'-'</span>) !== <span class="hljs-number">-1</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processSTDIN</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> input = <span class="hljs-string">''</span>;
  process.stdin.resume();
  process.stdin.setEncoding(<span class="hljs-string">'utf8'</span>);
  process.stdin.on(<span class="hljs-string">'data'</span>, data =&gt; {
    input += data;
  });
  process.stdin.on(<span class="hljs-string">'end'</span>, () =&gt; {
    processInputData(input);
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processFile</span>(<span class="hljs-params">file</span>) </span>{
  <span class="hljs-keyword">if</span> (!file) process.exit(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">if</span> (!options.syntax) options.syntax = path.extname(file).substring(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">var</span> css = fs.readFileSync(file, <span class="hljs-string">'utf-8'</span>).trim();
  processInputData(css);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processInputData</span>(<span class="hljs-params">input</span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">var</span> ast = gonzales.parse(input, {
      <span class="hljs-attr">syntax</span>: options.syntax,
      <span class="hljs-attr">context</span>: options.context
    });
    printTree(ast);
    process.exit(<span class="hljs-number">0</span>);
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-keyword">if</span> (!options.silent) process.stderr.write(e.toString());
    process.exit(<span class="hljs-number">1</span>);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">printTree</span>(<span class="hljs-params">ast</span>) </span>{
  <span class="hljs-keyword">if</span> (!options.simple) {
    <span class="hljs-keyword">var</span> tree = ast.toJson();
    process.stdout.write(tree);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> lastLevel;

    ast.traverse(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">node, i, parent, lastLevel</span>) </span>{
      <span class="hljs-keyword">var</span> type = node.type;
      <span class="hljs-keyword">var</span> spaces = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(lastLevel).join(<span class="hljs-string">' |'</span>);
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> node.content === <span class="hljs-string">'string'</span>) {
        <span class="hljs-keyword">var</span> content = <span class="hljs-built_in">JSON</span>.stringify(node.content);
        <span class="hljs-built_in">console</span>.log(spaces, <span class="hljs-string">'-&gt;'</span>, type);
        <span class="hljs-built_in">console</span>.log(spaces, <span class="hljs-string">'  '</span>, content);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">console</span>.log(spaces, <span class="hljs-string">'-&gt;'</span>, type);
      }
    });

    <span class="hljs-keyword">var</span> spaces = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(lastLevel).join(<span class="hljs-string">' -'</span>);
    <span class="hljs-built_in">console</span>.log(spaces);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">displayHelp</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> help = [
      <span class="hljs-string">'NAME'</span>,
      <span class="hljs-string">'    gonzlaes-pe â€” Parse a css file and print its parse tree in JSON'</span>,
      <span class="hljs-string">''</span>,
      <span class="hljs-string">'SYNOPSIS'</span>,
      <span class="hljs-string">'    gonzales-pe [options] file.js'</span>,
      <span class="hljs-string">'    cat file.js | gonzales-pe [options] -'</span>,
      <span class="hljs-string">''</span>,
      <span class="hljs-string">'OPTIONS'</span>,
      <span class="hljs-string">'    -s, --syntax'</span>,
      <span class="hljs-string">'        Syntax name: css, less, sass or scss.'</span>,
      <span class="hljs-string">'    -c, --context'</span>,
      <span class="hljs-string">'        Context of code part. See docs on node types for more info.'</span>,
      <span class="hljs-string">'    --simple'</span>,
      <span class="hljs-string">'        Print a simplified parse tree structure instead of JSON.'</span>,
      <span class="hljs-string">'    --silent'</span>,
      <span class="hljs-string">'        Don\'t print any error messages.'</span>
  ];
  <span class="hljs-built_in">console</span>.log(help.join(<span class="hljs-string">'\n'</span>));
}

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
