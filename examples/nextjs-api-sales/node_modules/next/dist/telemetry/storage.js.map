{"version":3,"sources":["../../telemetry/storage.ts"],"names":["chalk","Conf","BinaryLike","createHash","randomBytes","isDockerFunction","path","getAnonymousMeta","ciEnvironment","_postPayload","getRawProjectId","TELEMETRY_KEY_ENABLED","TELEMETRY_KEY_NOTIFY_DATE","TELEMETRY_KEY_ID","TELEMETRY_KEY_SALT","Telemetry","conf","sessionId","rawProjectId","NEXT_TELEMETRY_DISABLED","NEXT_TELEMETRY_DEBUG","queue","constructor","distDir","process","env","storageDirectory","getStorageDirectory","projectName","cwd","_","toString","Set","notify","isDisabled","get","set","Date","now","console","log","magenta","bold","cyan","anonymousId","val","generated","salt","setEnabled","_enabled","enabled","isEnabled","oneWayHash","payload","hash","update","digest","projectId","record","_events","_this","wrapper","submitRecord","prom","then","value","isFulfilled","isRejected","catch","reason","res","delete","add","flush","Promise","all","events","Array","isArray","length","resolve","forEach","eventName","error","JSON","stringify","context","meta","map","fields","isLikelyEphemeral","isCI","join","undefined"],"mappings":"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"}